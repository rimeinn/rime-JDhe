# Rime schema
# encoding: utf-8
# 本方案匹配词库解码顺序为：全拼拼音;简单鹤;自然码;虎码首末;官版鹤形
#############DIY你想要的方案组合吧###########################
set_shuru_schema:         #配置此项就是选择什么输入法,同时拆分反查和中英文混输也将匹配该输入方案
  __include: 小鹤双拼  #可选解码规则有   全拼，自然码，小鹤双拼
set_algebra_fuzhu:        #配置此项就是选择什么辅助码
  __include: fuzhu_jdh # 可选辅助码有：fuzhu_kong(空 无辅助码)，fuzhu_jdh(简单鹤), fuzhu_zrm(自然码), fuzhu_tiger(虎码), fuzhu_flypy(官鹤音形) 选择一个填入
set_fuzhu_type:                #直接辅助就是nire/=你，间接辅助就是ni/re=你，区别在于间接辅助不使用/引导的时候就和普通双拼没区别
  __include: 直接辅助           #可选的有：直接辅助、间接辅助
########################以下是方案配置######################################################


schema:
  schema_id: wanxiang_pinyin_dz
  name: 万象拼音·单字
  version: "2025-05-23"
  author:
    - amorphobia <xu350n9@gmail.com>
    - gaboolic,amzxyz
    - 方案修改：zHon 
  description: |
     万象拼音 支持常见双拼方案和全拼输入

switches:
  - name: ascii_mode
    reset: 0

engine:
  processors:
    - ascii_composer
    - key_binder
    - speller
    - recognizer
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - fallback_segmentor
  translators:
    - echo_translator #没有其他候选字时，回显输入码
    - table_translator
  filters:
    - uniquifier

# 拼写设定
speller:
  # 如果不想让什么标点直接上屏，可以加在 alphabet，或者编辑标点符号为两个及以上的映射
  alphabet: zyxwvutsrqponmlkjihgfedcba`;/
  # initials 定义仅作为始码的按键，排除 ` 让单个的 ` 可以直接上屏
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA`
  delimiter: " '"  # 第一位<空格>是拼音之间的分隔符；第二位<'>表示可以手动输入单引号来分割拼音。
  algebra:
    __patch:
      - set_shuru_schema     #拼音转双拼码
      - set_algebra_fuzhu    #辅助码选择
#      - set_fuzhu_type       #辅助码类型(反查中包含)
      - lookup   # 匹配反查


translator:
  dictionary: wanxiang_pinyin_dz
  enable_charset_filter: false
  enable_sentence: false
  enable_completion: true
  enable_user_dict: false
  disable_user_dict_for_patterns:
    - "^z.*$"

key_binder:
  import_preset: default

recognizer:
  import_preset: default

########## 万象词库解码规则，以下是拼写运算规则中全拼转双拼码以及形码的过程，按照不同的方案规则划分段落 ############
全拼: 
  __append: 
    - erase/^xx;.*$/

自然码: 
  __append:
    #- erase/^xx;.*$/
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/^([jqxy])u(;.*)$/$1v$2/
    - derive/^([aoe])([ioun])(;.*)$/$1$1$2$3/
    - xform/^([aoe])(ng)?(;.*)$/$1$1$2$3/
    - xform/^(\w+?)iu(;.*)$/$1Ⓠ$2/
    - xform/^(\w+?)[uv]an(;.*)$/$1Ⓡ$2/
    - xform/^(\w+?)[uv]e(;.*)$/$1Ⓣ$2/
    - xform/^(\w+?)ing(;.*)$/$1Ⓨ$2/
    - xform/^(\w+?)uai(;.*)$/$1Ⓨ$2/
    - xform/^(\w+?)uo(;.*)$/$1Ⓞ$2/
    - xform/^(\w+?)[uv]n(;.*)$/$1Ⓟ$2/
    - xform/^(\w+?)i?ong(;.*)$/$1Ⓢ$2/
    - xform/^(\w+?)[iu]ang(;.*)$/$1Ⓓ$2/
    - xform/^(\w+?)en(;.*)$/$1Ⓕ$2/
    - xform/^(\w+?)eng(;.*)$/$1Ⓖ$2/
    - xform/^(\w+?)ang(;.*)$/$1Ⓗ$2/
    - xform/^(\w+?)ian(;.*)$/$1Ⓜ$2/
    - xform/^(\w+?)an(;.*)$/$1Ⓙ$2/
    - xform/^(\w+?)iao(;.*)$/$1Ⓒ$2/
    - xform/^(\w+?)ao(;.*)$/$1Ⓚ$2/
    - xform/^(\w+?)ai(;.*)$/$1Ⓛ$2/
    - xform/^(\w+?)ei(;.*)$/$1Ⓩ$2/
    - xform/^(\w+?)ie(;.*)$/$1Ⓧ$2/
    - xform/^(\w+?)ui(;.*)$/$1Ⓥ$2/
    - xform/^(\w+?)ou(;.*)$/$1Ⓑ$2/
    - xform/^(\w+?)in(;.*)$/$1Ⓝ$2/
    - xform/^(\w+?)[iu]a(;.*)$/$1Ⓦ$2/
    - xform/^sh/Ⓤ/
    - xform/^ch/Ⓘ/
    - xform/^zh/Ⓥ/
    - xlit/ⓆⓌⓇⓉⓎⓊⒾⓄⓅⓈⒹⒻⒼⒽⓂⒿⒸⓀⓁⓏⓍⓋⒷⓃ/qwrtyuiopsdfghmjcklzxvbn/

小鹤双拼: 
  __append:
#    - erase/^xx$/
#    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/^([jqxy])u(;.*)$/$1v$2/
    - derive/^([aoe])([ioun])(;.*)$/$1$1$2$3/
    - xform/^([aoe])(ng)?(;.*)$/$1$1$2$3/
    - xform/^(\w+?)iu(;.*)/$1Ⓠ$2/
    - xform/^(\w+?)ei(;.*)/$1Ⓦ$2/
    - xform/^(\w+?)uan(;.*)/$1Ⓡ$2/
    - xform/^(\w+?)[uv]e(;.*)/$1Ⓣ$2/
    - xform/^(\w+?)un(;.*)/$1Ⓨ$2/
    - xform/^(\w+?)uo(;.*)/$1Ⓞ$2/
    - xform/^(\w+?)ie(;.*)/$1Ⓟ$2/
    - xform/^(\w+?)i?ong(;.*)/$1Ⓢ$2/
    - xform/^(\w+?)ing(;.*)/$1Ⓚ$2/
    - xform/^(\w+?)uai(;.*)/$1Ⓚ$2/
    - xform/^(\w+?)ai(;.*)/$1Ⓓ$2/
    - xform/^(\w+?)eng(;.*)/$1Ⓖ$2/
    - xform/^(\w+?)en(;.*)/$1Ⓕ$2/
    - xform/^(\w+?)[iu]ang(;.*)/$1Ⓛ$2/
    - xform/^(\w+?)ang(;.*)/$1Ⓗ$2/
    - xform/^(\w+?)ian(;.*)/$1Ⓜ$2/
    - xform/^(\w+?)an(;.*)/$1Ⓙ$2/
    - xform/^(\w+?)ou(;.*)/$1Ⓩ$2/
    - xform/^(\w+?)iao(;.*)/$1Ⓝ$2/
    - xform/^(\w+?)[iu]a(;.*)/$1Ⓧ$2/
    - xform/^(\w+?)ao(;.*)/$1Ⓒ$2/
    - xform/^(\w+?)ui(;.*)/$1Ⓥ$2/
    - xform/^(\w+?)in(;.*)/$1Ⓑ$2/
    - xform/^sh/Ⓤ/
    - xform/^ch/Ⓘ/
    - xform/^zh/Ⓥ/
    - xlit/ⓆⓌⓇⓉⓎⓊⒾⓄⓅⓈⒹⒻⒼⒽⒿⓀⓁⓏⓍⒸⓋⒷⓃⓂ/qwrtyuiopsdfghjklzxcvbnm/
  # 双拼简拼, 开启后可能性能不佳, 视情况开启
#    - abbrev/^(.).+$/$1/


###################### 以下是用来配置不同的辅助码方案 ###############################################
fuzhu_kong: 
  __append: 
    - "xform/;.*$//"
    - erase/^(.+);(.+)$/              # 刪除原始編碼以加速檢索
fuzhu_jdh:    ##############################位于词库第一个分号后
  __append:
    - xform|^(.*?);(.*?);.*$|$1;$2|       
fuzhu_zrm:   ####################################位于词库第二个分号后
  __append:
    - xform|^(.*?);.*?;(.*?);.*$|$1;$2|
fuzhu_tiger:  ########################################位于词库第三个分号后
  __append:
    - xform|^(.*?);.*?;.*?;(.*?);.*$|$1;$2|
fuzhu_flypy:    ########################################位于词库第四个分号后
  __append:  
    - xform|^(.*?);.*?;.*?;.*?;(.*?);.*$|$1;$2|

fuzhu_xx5:   ########################################位于词库第五个分号后
  __append:
    - xform|^(.*?);.*?;.*?;.*?;.*?;(.*?);.*$|$1;$2|

fuzhu_xx6:    ########################################位于词库第六个分号后
  __append:
    - xform|^(.*?);.*?;.*?;.*?;.*?;.*?;(.*?);.*$|$1;$2|

fuzhu_xx7:     ########################################位于词库第七个分号后
  __append:
    - xform|^(.*?);.*?;.*?;.*?;.*?;.*?;.*?;(.*?);.*$|$1;$2|

fuzhu_xx8:     ########################################位于词库第八个分号后
  __append:
    - xform|^(.*?);.*?;.*?;.*?;.*?;.*?;.*?;.*?;(.*?);.*$|$1;$2|    

直接辅助:
  __append:
#以下是双拼运算
    - derive/^(.+);.*$/$1/ # 纯双拼的情况
#分号后面第一组辅助码
    - derive/^(.+);(\w)(\w).*$/$1$2/ # 双拼+一位辅助码的情况
    - abbrev/^(.+);(\w)(\w).*$/$1$2$3/ # 双拼+2位辅助码的情况，abbrev类型不可以整句内输入2位辅助码，必须加/
    - derive|^(.+);(\w)(\w).*$|$1$2$3/| # 整句模式下，输入syff/ 出单字 增强单字性能
    - derive|^(.+);(\w)(\w).*$|$1$2$3o| # 整句模式下，输入syffo 出单字 增强单字性能
#分号后面第二组辅助码
    - derive/^(.+);.*?,(\w)(\w).*$/$1$2/
    - abbrev/^(.+);.*?,(\w)(\w).*$/$1$2$3/
    - derive|^(.+);.*?,(\w)(\w).*$|$1$2$3/|
    - derive|^(.+);.*?,(\w)(\w).*$|$1$2$3o|
#分号后面第三组辅助码
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$1$2/
    - abbrev/^(.+);.*?,.*?,(\w)(\w).*$/$1$2$3/
    - derive|^(.+);.*?,.*?,(\w)(\w).*$|$1$2$3/|
    - derive|^(.+);.*?,.*?,(\w)(\w).*$|$1$2$3o|
#分号后面第四组辅助码
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$1$2/ 
    - abbrev/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$1$2$3/
    - derive|^(.+);.*?,.*?,.*?,(\w)(\w).*$|$1$2$3/|
    - derive|^(.+);.*?,.*?,.*?,(\w)(\w).*$|$1$2$3o|
    - erase/^(.+);(.+)$/              # 刪除原始編碼以加速檢索

间接辅助:  ########################################位于词库第三个分号后
  __append:
#以下是双拼运算
    - derive/^(.+);.*$/$1/ # 纯双拼的情况
#分号后面第一组辅助码
    - derive|^(.*?);(\w).*$|$1/$3| # 双拼+一位辅助码的情况
    - derive|^(.*?);(\w)(\w).*$|$1/$3$4| # 双拼+2位辅助码的情
#分号后面第二组辅助码
    - derive|^(.*?);.*?,(\w).*$|$1/$3| # 双拼+一位辅助码的情况
    - derive|^(.*?);.*?,(\w)(\w).*$|$1/$3$4| # 双拼+2位辅助码的情况
#分号后面第三组辅助码
    - derive|^(.*?);.*?,.*?,(\w).*$|$1/$3| # 双拼+一位辅助码的情况
    - derive|^(.*?);.*?,.*?,(\w)(\w).*$|$1/$3$4| # 双拼+2位辅助码的情况
#分号后面第四组辅助码
    - derive|^(.*?);.*?,.*?,.*?,(\w).*$|$1/$3| # 双拼+一位辅助码的情况
    - derive|^(.*?);.*?,.*?,.*?,(\w)(\w).*$|$1/$3$4| # 双拼+2位辅助码的情况
    - erase/^(.+);(.+)$/    # 删除原始编码加速检索

############################################


############## 通配反查(作用不大) #####################

# 通配反查
lookup: 
  __append: 
 ## 可以用[`]通配反查的设定
#分号后面第一组辅助码
    - derive/^(.+);(\w)(\w).*$/$1$2$3/
    - derive/^(.+);(\w)(\w).*$/$1`/
    - derive/^(.+);(\w)(\w).*$/$1``/
    - derive/^(.+);(\w)(\w).*$/$1$2`/
    - derive/^(.+);(\w)(\w).*$/$1`$2/
    - derive/^(.+);(\w)(\w).*$/$1`$3/
    - derive/^(.+);(\w)(\w).*$/`$2$3/
    - derive/^(.+);(\w)(\w).*$/``$2$3/   
    - derive/^(.+);(\w)(\w).*$/``$2/ 
    - derive/^(.+);(\w)(\w).*$/``$2`/       
    - derive/^(.+);(\w)(\w).*$/``$3/   
    - derive/^(.+);(\w)(\w).*$/```$3/       
    - derive/^(.+);(\w)(\w).*$/$1`$2$3/    
    - derive/^(.+);(\w)(\w).*$/`$1$2$3/
#分号后面第二组辅助码
    - derive/^(.+);.*?,(\w)(\w).*$/$1$2$3/
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1`/
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1``/
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1$2`/
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1`$2/
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1`$3/
    - derive/^(.+);.*?,(\w)(\w).*$/$/`$2$3/
    - derive/^(.+);.*?,(\w)(\w).*$/$/``$2$3/   
    - derive/^(.+);.*?,(\w)(\w).*$/$/``$2/   
    - derive/^(.+);.*?,(\w)(\w).*$/$/``$2`/ 
    - derive/^(.+);.*?,(\w)(\w).*$/$/``$3/   
    - derive/^(.+);.*?,(\w)(\w).*$/$/```$3/   
    - derive/^(.+);.*?,(\w)(\w).*$/$/$1`$2$3/    
    - derive/^(.+);.*?,(\w)(\w).*$/$/`$1$2$3/
#分号后面第三组辅助码
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$1$2$3/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1`/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1``/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1$2`/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1`$2/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1`$3/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/`$2$3/
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/``$2$3/   
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/``$2/   
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/``$2`/   
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/``$3/   
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/```$3/  
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/$1`$2$3/    
    - derive/^(.+);.*?,.*?,(\w)(\w).*$/$/`$1$2$3/
#分号后面第四组辅助码
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$1$2$3/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1`/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1``/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1$2`/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1`$2/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1`$3/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/`$2$3/
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/``$2$3/   
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/``$2/   
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/``$2`/   
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/``$3/   
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/```$3/   
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/$1`$2$3/    
    - derive/^(.+);.*?,.*?,.*?,(\w)(\w).*$/$/`$1$2$3/
    - erase/^(.+);(.+)$/    # 删除原始编码加速检索



# 老旧的方式，词库编码得硬双拼
old_speller:
  __append:
    - derive/^(\w)(\w);(\w)(\w)$/\1\2\3\4/
    - derive/^(\w)(\w);(\w)(\w)$/\1\2`/
    - derive/^(\w)(\w);(\w)(\w)$/\1\2``/
    - derive/^(\w)(\w);(\w)(\w)$/\1\2\3`/
    - derive/^(\w)(\w);(\w)(\w)$/\1\2`\4/
    - derive/^(\w)(\w);(\w)(\w)$/``\3\4/
    - derive/^(\w)(\w);(\w)(\w)$/`\2\3\4/    
    - derive/^(\w)(\w);(\w)(\w)$/``\3/
    - derive/^(\w)(\w);(\w)(\w)$/```\4/
